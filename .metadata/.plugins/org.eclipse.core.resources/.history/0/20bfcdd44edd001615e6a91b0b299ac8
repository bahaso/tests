package bahaso.testing.general;

import java.util.ArrayList;

import org.bson.Document;
import org.bson.types.ObjectId;
import org.testng.Assert;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.Test;

import com.mongodb.BasicDBObject;
import com.mongodb.DB;
import com.mongodb.DBCollection;
import com.mongodb.DBCursor;
import com.mongodb.MongoClient;
import com.mongodb.client.FindIterable;
import com.mongodb.client.MongoCollection;
import com.mongodb.client.MongoDatabase;

public class cobamongo {
	MongoClient mongoClient = null;
	DB db = null;

	@BeforeClass
	public void beforeClass() {
		try {
			// STEP 1: Connect to database
			mongoClient = new MongoClient("localhost", 27017);
            db = mongoClient.getDB("mydb");
			//mongoClient = new MongoClient("localhost", 27017);
			//db = mongoClient.getDatabase("bahaso");
			System.out.println("Connect to database successfully");
		} catch (Exception e) {
			System.err.println(e.getClass().getName() + ": " + e.getMessage());
		}
	}

	@Test
	public void test() throws Exception {
		try {
			// STEP 2: Get Collection
			//MongoCollection<Document> table = db.getCollection("case_types");
			DBCollection coll = db.getCollection("testCollection");
			// STEP 3: Extract Data
			BasicDBObject searchQuery = new BasicDBObject();
			searchQuery.put("_id", new ObjectId("567925d1938e8e651c8b4579"));
			//FindIterable<Document> cursor = table.find();
			DBCursor cursor = coll.find();
			
			// STEP 4: Iterate over data
//			for (Document obj : cursor) {
//				Integer no = (Integer) obj.get("no");
//				String type = (String) obj.get("text");
//				//String lastName = obj.getString("question");
//				System.out.println(no + " " + type);
//			}
			while (cursor.hasNext()) {
				   DBObject obj = cursor.next();
				   //do your thing
			}

			
		} catch (Exception e) {
			// Handle errors for Class.forName
			e.printStackTrace();
		}
	}
	
}
